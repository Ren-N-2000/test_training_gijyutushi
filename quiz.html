<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æŠ€è¡“å£«è©¦é¨“ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 650px; margin: auto; }
    .choice { margin: 10px 0; }
    button { padding: 10px; width: 100%; margin-top: 5px; }
    .result { margin-top: 20px; font-weight: bold; }
    .next-btn, .mode-select { margin-top: 30px; text-align: center; }
    #explanation { margin-top: 10px; background: #f0f0f0; padding: 10px; display: none; }
  </style>
</head>
<body>
  <h1>æŠ€è¡“å£«è©¦é¨“ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>

  <h2 id="question"></h2>
  <div id="choices"></div>
  <div class="result" id="result"></div>
  <button id="explainBtn" onclick="showExplanation()" style="display:none;">è§£èª¬ã‚’è¦‹ã‚‹</button>
  <div id="explanation"></div>
  <div class="next-btn">
    <button onclick="nextQuestion()">æ¬¡ã®å•é¡Œã¸</button>
  </div>

<script>
  // ãƒ¢ãƒ¼ãƒ‰å–å¾—ï¼ˆâ˜…æœ€åˆã«å®Ÿè¡Œã™ã‚‹ã“ã¨ï¼‰
  function getModeFromURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get('mode') || 'basic';
  }
  const mode = getModeFromURL();

  const questions = [];

  // å•é¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆ6å•ã ã‘ä¾‹ç¤ºã€‚ä»¥é™è‡ªç”±ã«è¿½åŠ å¯ï¼‰
  questions.push(
    {
      level: "basic",
      question: "é‹¼æ§‹é€ ç‰©ã®æº¶æ¥ç¶™æ‰‹ã®è¨­è¨ˆä¸Šã®ç•™æ„ç‚¹ã«é–¢ã™ã‚‹è¨˜è¿°ã®ã†ã¡ã€æœ€ã‚‚ä¸é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ",
      choices: [
        "æº¶æ¥ç®‡æ‰€ã¯ã§ãã‚‹ã ã‘å°‘ãªãã—, æº¶æ¥é‡ã‚‚å¿…è¦æœ€å°é™ã¨ã™ã‚‹ã€‚",
        "è¡æ’ƒã‚„ç¹°è¿”ã—å¿œåŠ›ã‚’å—ã‘ã‚‹ç¶™æ‰‹ã¯ã§ãã‚‹ã ã‘å…¨æ–­é¢æº¶è¾¼ã¿ãƒ«ãƒ¼ãƒ— (é–‹å…ˆ) æº¶æ¥ã«ã™ã‚‹ã€‚",
        "æº¶æ¥ç¶™æ‰‹ã®çµ„ç«‹æ–¹æ³•, æº¶æ¥é †åºã‚’ååˆ†è€ƒæ…®ã—,ã§ãã‚‹ã ã‘ä¸Šå‘ãæº¶æ¥ãŒå¯èƒ½ãªæ§‹é€ ã¨ã™ã‚‹ã€‚",
        "é€£çµéƒ¨ã®æ§‹é€ ã¯ãªã‚‹ã¹ãå˜ç´”ã«ã—,å¿œåŠ›ã®ä¼é”ã‚’æ˜ç¢ºã«ã™ã‚‹ã€‚ æº¶æ¥ã®é›†ä¸­,äº¤å·®ã¯é¿ã‘,å¿…è¦ã«å¿œã˜ã¦ã‚¹ã‚«ãƒ©ãƒƒãƒ—(åˆ‡æ¬ ã)ã‚’è¨­ã‘ã‚‹ã€‚",
        "æ§‹æˆã™ã‚‹å„æç‰‡ã«ãŠã„ã¦ãªã‚‹ã¹ãåå¿ƒãŒãªã„ã‚ˆã†ã«ã—,ã§ãã‚‹ã ã‘æ¿åšå·®ã®å°‘ãªã„çµ„åˆã›ã‚’è€ƒãˆã‚‹ã€‚"
      ],
      answer: "æº¶æ¥ç¶™æ‰‹ã®çµ„ç«‹æ–¹æ³•, æº¶æ¥é †åºã‚’ååˆ†è€ƒæ…®ã—,ã§ãã‚‹ã ã‘ä¸Šå‘ãæº¶æ¥ãŒå¯èƒ½ãªæ§‹é€ ã¨ã™ã‚‹ã€‚",
      explanation: "ä¸Šå‘ãæº¶æ¥ã¯æ–½å·¥æ€§ãŒæ‚ªãã€ãƒŸã‚¹ã®åŸå› ã¨ãªã‚‹ãŸã‚é¿ã‘ã‚‹ã¹ãã§ã™ã€‚"
    },
    {
      level: "basic",
      question: "é‹¼æ©‹ã®ç¶­æŒç®¡ç†ã«é–¢ã™ã‚‹æ¬¡ã®è¨˜è¿°ã®ã†ã¡ã€æœ€ã‚‚ä¸é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ",
      choices: [
        "æ”¯æ‰¿å‘¨ã‚Šãªã©ã®æ»æ°´ãŒç”Ÿã˜ã‚„ã™ã„ç®‡æ‰€ã§ã¯é‹¼æã®è…é£ŸãŒé€²è¡Œã—ã‚„ã™ã„ã€‚",
        "éƒ¨æé€£çµéƒ¨ã«ãŠã„ã¦F11Tä»¥å¤–ã®é«˜åŠ›ãƒœãƒ«ãƒˆãŒä½¿ã‚ã‚Œã¦ã„ã‚‹å ´åˆ, ãƒœãƒ«ãƒˆã®é…ã‚Œç ´å£Šã®å±é™ºæ€§ãŒã‚ã‚‹ã€‚",
        "æ§‹é€ ç‰©ã«è‡ªå‹•è»Š, åˆ—è»Šãªã©ã®æ´»è·é‡, é¢¨ãªã©ã®å¤–åŠ›ãŒç¹°è¿”ã—ä½œç”¨ã™ã‚‹ã¨,æº¶æ¥ç¶™æ‰‹ã‚„æº¶æ¥æ¬ é™¥ãªã©ã®å¿œåŠ›é›†ä¸­éƒ¨ã«ç–²åŠ´ãè£‚ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚",
        "å¡—è£…ã«ãŠã„ã¦ã¯,é‹¼æè¡¨é¢ã•ã³ã‚’é™¤å»ã—, ä»˜ç€ã—ã¦ã„ã‚‹æœ‰å®³ç‰©è³ªã®é™¤å»ã¨å±¤é–“ä»˜ç€æ€§ã‚’è‰¯ãã™ã‚‹ãŸã‚ã®é¢ç²—ã—ã‚’è¡Œã†ã€‚",
        "ãè£‚ã®æº¶æ¥è£œä¿®ã«ãŠã„ã¦ã¯, å†æº¶æ¥ã«ã‚ˆã‚‹æ®‹ç•™å¿œåŠ›, ã²ãšã¿ã®å¢—åŠ ã€æ–°ãŸãªæº¶æ¥æ¬ é™¥ã®ç™ºç”Ÿãªã©æå‚·ç™ºç”Ÿå‰ã®çŠ¶æ…‹ã‚ˆã‚Šã‚‚ç–²åŠ´å¼·åº¦ãŒåŠ£ã‚‹å ´åˆãŒã‚ã‚‹ã€‚"
      ],
      answer: "éƒ¨æé€£çµéƒ¨ã«ãŠã„ã¦F11Tä»¥å¤–ã®é«˜åŠ›ãƒœãƒ«ãƒˆãŒä½¿ã‚ã‚Œã¦ã„ã‚‹å ´åˆ, ãƒœãƒ«ãƒˆã®é…ã‚Œç ´å£Šã®å±é™ºæ€§ãŒã‚ã‚‹ã€‚",
      explanation: "F11Tã‚‚é…ã‚Œç ´å£Šã®å±é™ºæ€§ãŒã‚ã‚‹ãŸã‚ã€è¨˜è¿°ãŒé™å®šçš„ã™ãã¦ä¸é©åˆ‡ã¨åˆ¤æ–­ã•ã‚Œã¾ã™ã€‚"
    }
  );

  let currentIndex = 0;

  function shuffle(array) {
    return array
      .map(value => ({ value, sort: Math.random() }))
      .sort((a, b) => a.sort - b.sort)
      .map(({ value }) => value);
  }

  function applyAdvancedMode(originalChoices, correctAnswer) {
    const modifiedChoices = [];
    const replacements = [
      ["ä¸Šå‘ã", "ä¸‹å‘ã"],
      ["å¿…è¦æœ€å°é™", "å¿…è¦ä»¥ä¸Š"],
      ["é™¤å»", "æ®‹å­˜"],
      ["è‰¯ãã™ã‚‹", "æ‚ªãã™ã‚‹"],
      ["é¿ã‘", "é›†ä¸­ã—"],
      ["å°‘ãªã„", "å¤šã„"],
      ["æ˜ç¢ºã«", "ä¸æ˜ç¢ºã«"],
      ["å¯èƒ½", "å›°é›£"]
    ];
    let newCorrect = correctAnswer;
    if (Math.random() < 0.5) {
      for (const [from, to] of replacements) {
        if (correctAnswer.includes(from)) {
          newCorrect = correctAnswer.replace(from, to);
          break;
        }
      }
    }
    for (let choice of originalChoices) {
      if (choice === correctAnswer) {
        modifiedChoices.push(newCorrect);
      } else if (Math.random() < 0.3) {
        modifiedChoices.push(correctAnswer);
      } else {
        modifiedChoices.push(choice);
      }
    }
    return { choices: modifiedChoices, answer: newCorrect };
  }

  function showQuestion() {
    const filtered = questions.filter(q => q.level === mode);
    const q = filtered[currentIndex % filtered.length];
    const questionElem = document.getElementById('question');
    const choicesElem = document.getElementById('choices');
    const resultElem = document.getElementById('result');
    const explainBtn = document.getElementById('explainBtn');
    const explanation = document.getElementById('explanation');

    resultElem.textContent = '';
    explanation.style.display = "none";
    explanation.textContent = '';
    explainBtn.style.display = "none";
    choicesElem.innerHTML = '';

    questionElem.textContent = "Q. " + q.question;

    let finalChoices = [...q.choices];
    let correct = q.answer;

    if (mode === "advanced") {
      const result = applyAdvancedMode(finalChoices, correct);
      finalChoices = result.choices;
      correct = result.answer;
    }

    const shuffled = shuffle(finalChoices);

    shuffled.forEach(choice => {
      const btn = document.createElement('button');
      btn.textContent = choice;
      btn.className = 'choice';
      btn.onclick = () => {
        resultElem.textContent = (choice === correct)
          ? "âœ… æ­£è§£ï¼"
          : "âŒ ä¸æ­£è§£ã€‚æ­£è§£ã¯ã€Œ" + correct + "ã€";
        resultElem.style.color = (choice === correct) ? "green" : "red";
        explainBtn.style.display = "inline-block";
      };
      choicesElem.appendChild(btn);
    });
  }

  function nextQuestion() {
    currentIndex++;
    showQuestion();
  }

  function showExplanation() {
    const filtered = questions.filter(q => q.level === mode);
    const q = filtered[currentIndex % filtered.length];
    const explanation = document.getElementById('explanation');
    explanation.style.display = "block";
    explanation.textContent = "ğŸ§  ChatGPTè§£èª¬: " + q.explanation;
  }

  // åˆå›è¡¨ç¤º
  showQuestion();
</script>
</body>
</html>